package com.kindred.islab1.controllers;

import com.kindred.islab1.entities.Coordinates;
import com.kindred.islab1.entities.Flat;
import com.kindred.islab1.entities.House;
import com.kindred.islab1.services.FlatService;
import jakarta.validation.Valid;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

@CrossOrigin(origins = "http://localhost:5173")
@RestController
@RequestMapping("/api/flats")
public class FlatController {
    private final FlatService flatService;

    @Autowired
    public FlatController(FlatService flatService) {
        this.flatService = flatService;
    }

    // TODO
    //  –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:
    //  ‚úî    –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ –∫–ª–∞—Å—Å–∞.
    //  ‚úî    –ù–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏: —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±—ä–µ–∫—Ç–µ –ø–æ –ò–î, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤), —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞. –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±—ä–µ–∫—Ç–µ –∫–ª–∞—Å—Å–∞ –¥–æ–ª–∂–Ω–∞ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –Ω–∏–º –æ–±—ä–µ–∫—Ç–∞—Ö.
    //  ‚úî    –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–≤—è–∑–∞—Ç—å –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º –∏ —É–∂–µ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ.
    //  ‚úî    –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –æ–±—ä–µ–∫—Ç–∞–º–∏ –¥–æ–ª–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ (–Ω–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ), –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
    //  ‚úî    –ù–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–µ–Ω –≤—ã–≤–æ–¥–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –æ–±—ä–µ—Ç–æ–≤ –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã (–∫–∞–∂–¥—ã–π –∞—Ç—Ä–∏–±—É—Ç –æ–±—ä–µ–∫—Ç–∞ - –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ). –ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è (–µ—Å–ª–∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º —ç–∫—Ä–∞–Ω–µ).
    //      –ù—É–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å/—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–±—ä–µ–∫—Ç—ã (–ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –ª—é–±–æ–π –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫). –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –ø–æ –Ω–µ–ø–æ–ª–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é.
    //  ‚úî    –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏) –æ–±—ä–µ–∫—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–æ–∑–º–æ–∂–µ–Ω –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å –æ–±—â–∏–º —Å–ø–∏—Å–∫–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ–±—ä–µ–∫—Ç–∞ (–ø—Ä–∏ –µ–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).
    //      –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞, –æ–Ω –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—å—Å—è/–∏—Å—á–µ–∑–Ω—É—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö —É –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.
    //  ‚úî    –ï—Å–ª–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ —Å –Ω–∏–º —Å–≤—è–∑–∞–Ω –¥—Ä—É–≥–æ–π –æ–±—ä–µ–∫—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª—è—Ç—å—Å—è.
    //  ‚úî    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –£ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω –ø–∞—Ä–æ–ª—å. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é: –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ n —Å–∏–º–≤–æ–ª–æ–≤. –í —Å–∏—Å—Ç–µ–º–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∏–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ä–æ–ª–µ–π):–æ–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã. –ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ —É–∂–µ —Å–æ–∑–¥–∞–Ω —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –æ–¥–Ω–∏–º –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞—è–≤–æ–∫ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏—Ö –æ–¥–æ–±—Ä–µ–Ω–∏—è).
    //  ‚úî    –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –æ–±—ä–µ–∫—Ç—ã –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Ö —Å–æ–∑–¥–∞–ª–∏, –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã).
    //  ‚úî    –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å (–æ–±–Ω–æ–≤–ª—è—Ç—å) –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∏–º (–æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –µ—Å–ª–∏ –æ–Ω –µ–≥–æ —Å–æ–∑–¥–∞–ª). –î–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ. –ü—Ä–∏ –≤–≤–æ–¥–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –ø–æ–ª—è –æ–±—ä–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –æ—à–∏–±–∫–∞—Ö.
    //  –í —Å–∏—Å—Ç–µ–º–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –æ–±—ä–µ–∫—Ç–∞–º–∏:
    //  ‚úî    –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è numberOfRooms –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
    //  ‚úî    –í–µ—Ä–Ω—É—Ç—å –æ–¥–∏–Ω (–ª—é–±–æ–π) –æ–±—ä–µ–∫—Ç, –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è area –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º.
    //  ‚úî    –í–µ—Ä–Ω—É—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤, –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è new –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ.
    //  ‚úî    –ù–∞–π—Ç–∏ —Å–∞–º—É—é –¥–æ—Ä–æ–≥—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É –±–µ–∑ –±–∞–ª–∫–æ–Ω–∞.
    //  üóπ    –í—ã–±—Ä–∞—Ç—å –∏–∑ —Ç—Ä—ë—Ö –∫–≤–∞—Ä—Ç–∏—Ä —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º id –Ω–∞–∏–±–æ–ª–µ–µ –¥–æ—Ä–æ–≥—É—é
    //  ‚úî    –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä –ë–î.
    //  ‚úî –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ:
    //  ‚úî    –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–±—ä–µ–∫—Ç–∞—Ö –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –°–£–ë–î (PostgreSQL). –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–°, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    //  ‚úî    –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–ª—è–º –∫–ª–∞—Å—Å–∞ (—É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –æ–ø–∏—Å–∞–Ω–∏—é –∫–ª–∞—Å—Å–æ–≤) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ ORM –∏ –ë–î.
    //  ‚úî    –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—è id –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
    //  ‚úî    –ü–∞—Ä–æ–ª–∏ –ø—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º SHA-384.
    //  ‚úî    –ü—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç, –∞ —Ç–∞–∫–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–ª—è–ª–∏ –∏ –∏–∑–º–µ–Ω—è–ª–∏ –æ–±—ä–µ–∫—Ç—ã. –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω—É–∂–Ω–æ –ø—Ä–æ–¥—É–º–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã.
    //  ‚úî    –¢–∞–±–ª–∏—Ü—ã –ë–î, –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–µ –∑–∞–¥–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ–±—ä–µ–∫—Ç–æ–≤, –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å 3–ù–§.
    //  ‚úî    –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –Ω–∞ –∫–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö–æ—Å—Ç pg, –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö - studs, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–ø–∞—Ä–æ–ª—å —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Ç–∞–∫–æ–≤—ã–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É.
    //  ‚úî –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    //  ‚úî    –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è –≤–≤–æ–¥ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –ø—Ä–∏—á–∏–Ω–µ –æ—à–∏–±–∫–∏.
    //  ‚úî    –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω—ã–º–∏ —á–∞—Å—Ç—è–º–∏ —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–Ω—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é –º–µ–Ω—é.
    //  ‚úî    –í–æ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–∫—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    //  -    [–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ - +2 –±–∞–ª–ª] –í –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ –ò–° –¥–æ–ª–∂–Ω–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –ü—Ä–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∏ —Ä–∞–∑–º–µ—Ä–∞—Ö –æ–±—ä–µ–∫—Ç–∞. –û–±—ä–µ–∫—Ç—ã –æ—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω—ã —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç –¥–æ–ª–∂–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç—Ç–æ–º –æ–±—ä–µ–∫—Ç–µ.
    //  -    –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞, –æ–Ω –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—å—Å—è/–∏—Å—á–µ–∑–Ω—É—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ –æ–±–ª–∞—Å—Ç–∏ —É –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
    //  ‚úî –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ò–° –¥–æ–ª–∂–Ω—ã —É—á–∏—Ç—ã–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
    //  ‚úî    –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ò–° –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Spring MVC.
    //  ‚úî    –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–≤–Ω—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Hibernate.
    //  ‚úî    –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–¥–µ–ª–µ–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, —Ä–∞–∑–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏ –ò–° –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.


    @PostMapping
    public ResponseEntity<Map<String, Object>> createFlat(@AuthenticationPrincipal UserDetails userDetails, @Valid @RequestBody Flat flat) {
        Map<String, Object> response = new HashMap<>();

        response.put("flat", flatService.createFlat(flat, userDetails.getUsername()));
        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    @PostMapping("/house")
    public ResponseEntity<Map<String, Object>> createHouse(@AuthenticationPrincipal UserDetails userDetails, @Valid @RequestBody House house) {
        Map<String, Object> response = new HashMap<>();
        response.put("house", flatService.createHouse(house, userDetails.getUsername()));
        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    @PostMapping("/coordinates")
    public ResponseEntity<Map<String, Object>> createCoordinates(@AuthenticationPrincipal UserDetails userDetails, @Valid @RequestBody Coordinates coordinates) {
        Map<String, Object> response = new HashMap<>();
        response.put("coordinates", flatService.createCoordinates(coordinates, userDetails.getUsername()));
        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    @GetMapping("/houses")
    public ResponseEntity<Map<String, Object>> getHouse() {
        Map<String, Object> response = new HashMap<>();
        response.put("houses", flatService.getHouses());
        return new ResponseEntity<>(response, HttpStatus.OK);
    }

    @GetMapping("/coordinates")
    public ResponseEntity<Map<String, Object>> getCoordinates() {
        Map<String, Object> response = new HashMap<>();
        response.put("coordinates", flatService.getCoordinates());
        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    @GetMapping("/{id}")
    public ResponseEntity<Map<String, Object>> getFlat(@PathVariable Long id) {
        Map<String, Object> response = new HashMap<>();
        response.put("flat", flatService.getFlat(id));
        return new ResponseEntity<>(response, HttpStatus.OK);
    }

    @PutMapping
    public ResponseEntity<Map<String, Object>> updateFlat(@AuthenticationPrincipal UserDetails userDetails, @Valid @RequestBody Flat flatDetails) {
        Map<String, Object> response = new HashMap<>();
        response.put("updatedFlat", flatService.updateFlat(flatDetails, userDetails.getUsername()));
        return new ResponseEntity<>(response, HttpStatus.OK);
    }

    @DeleteMapping("/{id}")
    public ResponseEntity<Map<String, Object>> deleteFlat(@AuthenticationPrincipal UserDetails userDetails, @PathVariable Long id) {
        Map<String, Object> response = new HashMap<>();
        flatService.deleteFlat(id, userDetails.getUsername());
        return new ResponseEntity<>(response, HttpStatus.OK);
    }

    @GetMapping("/flat-list")
    public ResponseEntity<Map<String, Object>> getFlatList() {
        Map<String, Object> response = new HashMap<>();
        response.put("flats", flatService.getAllFlats());
        return new ResponseEntity<>(response, HttpStatus.OK);
    }
}
